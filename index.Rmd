---
title: "Gov 50 Final Project"
author: "Courtney Taylor"
description: "My final project"
output:
  distill::distill_article:
    self_contained: false
---



## Project thoughts

Milestone 1: Create public GitHub repository: I am interested in exploring data related to socioeconomic levels within the United States. I am wondering how children or family sizes could affect someones socioeconomic level or their income. This is interesting as our country was known for having a large middle class, but this has slowly deteriorated over time. Now, America is struggling to keep the middle class alive. I would like to analyaze if family size plays a role in this by decreasing incomes of a single person within the particular family. 



Milestone 2: Finding data and writing a proposal: 











Milestone 3:

```{r}
library(readr)
library(tidyverse)
library(dplyr)
library(infer)
youth_dataset_long_form <- read_csv("~/Desktop/Final Project/youth-dataset-long-form.csv")
```



Family Size 1 versus Family Size more than 1, ATE
```{r}
set.seed(02138)

youth_dataset_long_form <- youth_dataset_long_form |>
  mutate(
    FAMSIZE_group = case_when(
      FAMSIZE_ < 5 ~ "1. 1-4 Family Size",
      FAMSIZE_ >= 5 & FAMSIZE_ <= 10 ~ "2. 5-10 Family Size",
      FAMSIZE_ > 15 ~ "3. 11-15 Family Size"
    )) 

youth_dataset_long_form <- youth_dataset_long_form |>
  mutate(treatment = if_else(FAMSIZE_ > 1, "Treated", "Control"))
 
family_ate <- youth_dataset_long_form |>
group_by(treatment) |>
summarize(mean_income = mean(INCOME_)) |>
pivot_wider(names_from = treatment, values_from = mean_income) |>
mutate(ATE = `Treated` - `Control` )
family_ate

family_ate
```
Explanation: 

From the table above, I decided to analyze if those who have at least one family member in their family besides themselves, will have a higher or lower income than someone who is the only person in their family. In terms of the control and the treated, the control is those who are the only member of their family. Treated encompasses those who have more than just themselves in their family, or at least one other family member besides themselves. From the information given above, we can see that those who have an additional family member will have an average income of $15,797.46 while those who are by themselves will have an average income of $16,968.84. This means that those who are by themselves in their family, will have an average increase of $1,171.38 in comparison to those who have at least one other family member. This provides evidence towards rejecting my null hypothesis as I had previously hypothesized that there will be a decrease in income for those who have family members compared to those who do not. 










Regression:
```{r}
library(stargazer)

fit_ate <- lm(INCOME_ ~ treatment + COUNTRY_OF_BIRTH + SAMPLE_RACE + SAMPLE_SEX + FAMSIZE_ + POVSTATUS_ + REGION_ + EDU_DEGREE + EMP_STATUS_, data = youth_dataset_long_form)

summary(fit_ate)
```
Explanation: 








Histogram Showing Income:
```{r}
library(ggplot2)

set.seed(02138)

income_hist <- ggplot(youth_dataset_long_form, aes(x = INCOME_, fill = as.factor(FAMSIZE_group))) +
  geom_histogram(alpha = 0.7) +
  labs(title = "Income Distribution by Family Size",
       x = "Income",
       y = "Frequency") +
  scale_x_log10(labels = scales::dollar_format())

income_hist
```
Explanation:








95% Confidence Interval To Fail To Reject Null Hypothesis:
```{r}
set.seed(02138)

ate <- youth_dataset_long_form |>
  specify(INCOME_ ~ treatment) |>
  calculate(stat = "diff in means", order = c("Treated", "Control"))

ate_null_dist <- youth_dataset_long_form |>
  specify(INCOME_ ~ treatment) |>
  hypothesize(null = "independence") |>
  generate(reps = 1000, type = "permute") |>
  calculate(stat = "diff in means", order = c("Treated", "Control"))

ate_p <- ate_null_dist |>
  get_p_value(obs_stat = ate, direction = "both")

ate_null_dist |>
  visualize() +
  shade_p_value(obs_stat = ate, direction = "both")
```
Explanation:








Family Size Mean Income:
```{r}
set.seed(02138)

youth_dataset_long_form <- youth_dataset_long_form |>
  mutate(
    FAMSIZE_group = case_when(
      FAMSIZE_ < 5 ~ "1. 1-4 Family Size",
      FAMSIZE_ >= 5 & FAMSIZE_ <= 10 ~ "2. 5-10 Family Size",
      FAMSIZE_ > 15 ~ "3. 11-15 Family Size"
    ))

youth_dataset_long_form$FAMSIZE_group <- factor(youth_dataset_long_form$FAMSIZE_group, 
                                                levels = c("1. 1-4 Family Size", "2. 5-10 Family Size", "3. 11-15 Family Size"))

means_by_family_size <- youth_dataset_long_form |>
  group_by(FAMSIZE_group) |>
  summarise(mean_income = mean(INCOME_, na.rm = TRUE))

means_by_family_size
```
Explanation:

In this table, I grouped together family sizes into three categories: 1-4 Family Size, 5-10 Family Size, and 11-15 Family Size. I then calculated the mean income for every level to see an average income for one person in a family between the sizes in each category. As we can see, those in a family size between 1 and 4, will have the most income with it being an average of $17,401.82. Those with the smallest amount of income will be those in the 5-10 family size group which goes against my initial theory of the more people in a family means the less income a person will have. Since the middle group of 5-10 has the lowest income, this provides evidence toward me failing to reject my null hypothesis. 








How The Size of a Family Can Affect Income:
```{r}
library(ggplot2)
library(infer)

youth_dataset_long_form |>
  slice_sample(n = 1000)

ggplot(youth_dataset_long_form, aes(x = FAMSIZE_, y = INCOME_, color = SAMPLE_RACE)) +
  geom_jitter(alpha = 0.5) +
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE, color = "black") +
  labs(
    x = "Family Size",
    y = "Income ($)",
    color = "Race"
  ) +
  theme_minimal() +
  scale_y_continuous(labels = scales::comma)

ggplot
```


Explanation for Visual: The visual above represents a scatter plot representing the relationship between income and family size, and the points are color coded to the race that each individual is. The regression line is here to show the relationship between the two variables to further predict the value of the dependent variable for a given value of the independent variable. The results from the scatter plot show that first, most of the individuals within this data set are below the $200,000 income level. It also shows that while every race is spread throughout the amount of children each family has, black people and Hispanic people tend to be the only ones who have more than 11 children within their family. It is also seen that there is a decline in income level in relation to the amount of children a family has. For every child born into a family, the income level will decrease. There are also some points in the higher income level area between $200,000 and $350,000 but even these points tend to stick in the small amount of family members area, mainly staying between 1 and 7 family members. There are 8 outlying points closer to the 10 family member mark, but these can be taken with small value into the graph. From this graph it is clear that when adding family members, a person's income will decrease. This provides evidence for me to reject my null hypothesis. 





Milestone 4:

A Formatted Table to Represent Above Scatterplot:
```{r}
library(ggplot2)
library(scales)
library(gt)
library(tidyverse)
library(dplyr)

plot_data <- youth_dataset_long_form

table_summary <- plot_data |>
  select(FAMSIZE_, INCOME_MAX, SAMPLE_RACE) |>
  filter(FAMSIZE_ >= 1) |>
  group_by(FAMSIZE_, SAMPLE_RACE) |>
  summarise(avg_income = mean(INCOME_MAX, na.rm = TRUE)) |>
  gt() |>
  tab_header(
    title = "Summary Table",
    subtitle = "Average Income by Family Size and Race"
  ) |>
  fmt_number(
    columns = vars(avg_income),
    suffixing = TRUE,
    decimals = 2
  )

table_summary
```

Above I created a table showing the relationship between family size, race, and average maximum income; this is grouped through family size. This nicely formatted table showing the results of my graph, shows that there is indeed a correlation between average maximum income and family size as income begins to drop quickly once family sizes reach 6 and above. To compare, a black family of 5 will have a single person with an income of 40.16k while a black family of 18 will have a single person with an income of 5.00k. I also noticed a large difference between Black families, Hispanic families, and non-black, non-Hispanic families. To compare, a black family of 3 will have an average maximum income of 43.10k, while a Hispanic family of 3 will have an average maximum income of 50.33k, and finally a non-black, non-Hispanic family of 3 will have an average maximum income of 53.50k. While race plays no part in my hypothesis, it is an interesting confounder that could be in play when it comes to family size affecting income. From this nicely formatted table, evidence is provided that allows me to reject my null hypothesis. 


